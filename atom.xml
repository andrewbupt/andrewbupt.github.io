<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title><![CDATA[Andrew's blog]]></title>
  <subtitle><![CDATA[Action speak louder than words.]]></subtitle>
  <link href="/atom.xml" rel="self"/>
  <link href="http://yoursite.com/"/>
  <updated>2015-03-01T15:58:32.318Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name><![CDATA[Andrew]]></name>
    <email><![CDATA[andrewzjl@163.com]]></email>
  </author>
  
  <generator uri="http://zespia.tw/hexo/">Hexo</generator>
  
  <entry>
    <title><![CDATA[如何让APP成为Mac文件的默认打开程序]]></title>
    <link href="http://yoursite.com/2015/03/01/Change-files-default-associate-app-by-IceBerg/"/>
    <id>http://yoursite.com/2015/03/01/Change-files-default-associate-app-by-IceBerg/</id>
    <published>2015-03-01T02:04:57.000Z</published>
    <updated>2015-03-01T15:58:10.871Z</updated>
    <content type="html"><![CDATA[<p>  公司的Mac App产品，需要设置成为打开特定格式(.CSV 和 .XLS)文件的默认程序。<br>  经过调研，在程序启动后向OSX系统com.apple.LaunchServices服务，写入特定的信息，可以满足需求。但是用户可能更想要在将APP安装后，即成为特定文件的默认打开程序，而不是在首次启动程序之后。<br>  这就需要在将APP下载到Mac上之后，能自动执行一些脚本。因为Mac的普通APP安装，其实就是从DMG虚拟磁盘文件里或网上直接将APP拷贝到Mac上，期间无法进行脚本调用。于是只能借用打包软件，让用户按步骤安装。<br>  我找到了IceBerg这款开源打包软件。软件很容易上手，执行也很快，打包之后的压缩大小和zip压缩幅度差不多。<br>  但在使用过程中，发现脚本执行结果和预期的不一样。<br>脚本如下：<br>·<br>    echo “clear user/system local session cache” &gt;&gt; ~/.Log.log<br>    /System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/LaunchServices.framework/Versions/A/Support/lsregister -kill -domain local -domain system -domain user<br>    echo “registe 1-tier as xls/csv default app” &gt;&gt; ~/.Log.log<br>    defaults write com.apple.LaunchServices LSHandlers -array-add “<dict><key>LSHandlerContentTag</key><string>xls</string><key>LSHandlerContentTagClass</key><string>public.filename-extension</string><key>LSHandlerRoleAll</key><string><strong><em>.</em></strong></string></dict>“<br>    defaults write com.apple.LaunchServices LSHandlers -array-add “<dict><key>LSHandlerContentTag</key><string>csv</string><key>LSHandlerContentTagClass</key><string>public.filename-extension</string><key>LSHandlerRoleAll</key><string><strong><em>.</em></strong></string></dict>“<br>·<br>  单独在shell中用sh方式执行脚本的时候，defaults read com.apple.LaunchServices LSHandlers 可以看到csv/xls两个选项被增加了,但当IceBerg调用脚本执行后，并不会增加任何选项。通过日志方式，发现脚本的确是执行了的。<br>  百思不得其解，无奈插入新的日志<br>·<br>    defaults read com.apple.LaunchServices LSHandlers &gt;&gt; ~/.Log.log<br>·<br>  发现读取出来的list和在shell中的不一样。难道不是同一个用户？<br>    who am i &gt; ~/.InstallOnetierLog.log<br>  BINGO！IceBerg不是用当前操作用户账户、而是用root账户执行脚本。<br>  需要在脚本里切换用户该怎么办呢？搜索之……<br>  果然也有人在问—[Shell 中切换用户][1]。<br>  但又有一个问题了，怎么确定当前用户是谁呢？<br>  再次搜索……<br>  有显示用户的命令如<br><code>id -un #获取当前用户
    who | cut -d&#39; &#39; -f1 | sort | uniq #获取所有登录用户</code><br>  但是因为Iceberg是采用root用户执行脚本，如果在多用户登录的情况下，以上命令都无法准确的确定软件使用者的真正用户名。<br>  根据特殊情况，我发现Iceberg在用root用户执行脚本时，依然是采用的当前用户的环境变量。于是，</p>
<pre><code>currentuser=<span class="smartquote">`ls -ld ~ | cut -d '</span> ' -f3`
</code></pre><p>  对于home目录的所有者，99%应该都是当前用户本身。对于普通用户来说，那1%例外就暂时不考虑了。<br>  最终如下尝试，顺利解决问题。</p>
<pre><code><span class="xml">#!/bin/sh
currentuser=`ls -ld ~ | cut -d ' ' -f3`
su - $currentuser <span class="tag">&lt;&lt;!
<span class="attribute">defaults</span> <span class="attribute">read</span> <span class="attribute">com.apple.LaunchServices</span> <span class="attribute">LSHandlers</span> &gt;</span>&gt; ~/.Log.log
echo "clear user/system local session cache" &gt;&gt; ~/.Log.log
/System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/LaunchServices.framework/Versions/A/Support/lsregister -kill -domain local -domain system -domain user
echo "registe as xls/csv default app" &gt;&gt; ~/.Log.log
defaults write com.apple.LaunchServices LSHandlers -array-add "<span class="tag">&lt;<span class="title">dict</span>&gt;</span><span class="tag">&lt;<span class="title">key</span>&gt;</span>LSHandlerContentTag<span class="tag">&lt;/<span class="title">key</span>&gt;</span><span class="tag">&lt;<span class="title">string</span>&gt;</span>xls<span class="tag">&lt;/<span class="title">string</span>&gt;</span><span class="tag">&lt;<span class="title">key</span>&gt;</span>LSHandlerContentTagClass<span class="tag">&lt;/<span class="title">key</span>&gt;</span><span class="tag">&lt;<span class="title">string</span>&gt;</span>public.filename-extension<span class="tag">&lt;/<span class="title">string</span>&gt;</span><span class="tag">&lt;<span class="title">key</span>&gt;</span>LSHandlerRoleAll<span class="tag">&lt;/<span class="title">key</span>&gt;</span><span class="tag">&lt;<span class="title">string</span>&gt;</span>Microstrategy.MicroStrategy<span class="tag">&lt;/<span class="title">string</span>&gt;</span><span class="tag">&lt;/<span class="title">dict</span>&gt;</span>"
defaults write com.apple.LaunchServices LSHandlers -array-add "<span class="tag">&lt;<span class="title">dict</span>&gt;</span><span class="tag">&lt;<span class="title">key</span>&gt;</span>LSHandlerContentTag<span class="tag">&lt;/<span class="title">key</span>&gt;</span><span class="tag">&lt;<span class="title">string</span>&gt;</span>csv<span class="tag">&lt;/<span class="title">string</span>&gt;</span><span class="tag">&lt;<span class="title">key</span>&gt;</span>LSHandlerContentTagClass<span class="tag">&lt;/<span class="title">key</span>&gt;</span><span class="tag">&lt;<span class="title">string</span>&gt;</span>public.filename-extension<span class="tag">&lt;/<span class="title">string</span>&gt;</span><span class="tag">&lt;<span class="title">key</span>&gt;</span>LSHandlerRoleAll<span class="tag">&lt;/<span class="title">key</span>&gt;</span><span class="tag">&lt;<span class="title">string</span>&gt;</span>Microstrategy.MicroStrategy<span class="tag">&lt;/<span class="title">string</span>&gt;</span><span class="tag">&lt;/<span class="title">dict</span>&gt;</span>"
defaults read com.apple.LaunchServices LSHandlers &gt;&gt; ~/.Log.log
exit
!
exit 0</span>
</code></pre><h1 id="参考文献">参考文献</h1>
<p>[1] <a href="http://bbs.chinaunix.net/thread-2306026-1-1.html" target="_blank" rel="external">Shell 中切换用户</a><br>[2] <a href="http://blog.csdn.net/newdriver2783/article/details/8059368" target="_blank" rel="external">Linux下用于查看系统当前登录用户信息的4种方法</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<p>  公司的Mac App产品，需要设置成为打开特定格式(.CSV 和 .XLS)文件的默认程序。<br>  经过调研，在程序启动后向OSX系统com.apple.LaunchServices服务，写入特定的信息，可以满足需求。但是用户可能更想要在将APP安装后，即成为特定文]]>
    </summary>
    
      <category term="原创" scheme="http://yoursite.com/tags/%E5%8E%9F%E5%88%9B/"/>
    
      <category term="OSX" scheme="http://yoursite.com/tags/OSX/"/>
    
      <category term="shell script" scheme="http://yoursite.com/tags/shell-script/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[做不到七点别喝豆浆]]></title>
    <link href="http://yoursite.com/2015/02/28/don-t-drink-bean-milk-if-you-don-t-know-this/"/>
    <id>http://yoursite.com/2015/02/28/don-t-drink-bean-milk-if-you-don-t-know-this/</id>
    <published>2015-02-27T16:05:15.000Z</published>
    <updated>2015-02-27T16:19:46.183Z</updated>
    <content type="html"><![CDATA[<p>　　一、豆浆性质偏寒，消化不良、嗝气和肾功能不好的人，最好少喝豆浆。另外，急性胃炎和慢性浅表性胃炎者不宜食用豆制品，以免刺激胃酸分泌过多加重病情，或者引起胃肠胀气。</p>
<p>　　二、豆浆里不能加红糖，因为红糖里面有多种有机酸，它们和豆浆里的蛋白酶结合，不容易被人体吸收。而加白糖就不会有这种现象。</p>
<p>　　三、有人喜欢用暖瓶装豆浆来保温，这种方法不足取，因为暖瓶温湿的内环境极有利于细菌繁殖。另外豆浆里的皂毒素还能够溶解暖瓶里的水垢，喝了会危害人体健康。</p>
<p>　　四、由于豆浆是由大豆制成的，而大豆里面含嘌呤成分很高，且属于寒性食物，所以有痛风症状、乏力、体虚、精神疲倦等症状的虚寒体质者都不适宜饮用豆浆。</p>
<p>　　五、豆浆不但必须要煮开，而且在煮豆浆时还必须要敞开锅盖，这是因为只有敞开锅盖才可以让豆浆里的有害物质随着水蒸气挥发掉。</p>
<p>　　六、豆浆一定不要与红霉素等抗生素一起服用，因为二者会发生化学反应，喝豆浆与服用抗生素的间隔时间最好在1个小时以上。</p>
<p>　　七、常喝豆浆注意补锌，豆类中含有抑制剂、皂角素和外源凝集素，这些都是对人体不好的物质。对付它们的最好方法就是将豆浆煮熟，长期食用豆浆的人不要忘记补充微量元素锌。</p>
<p>　　注意：</p>
<p>　　喝豆浆时最好不要加糖或蜂蜜，如果觉得淡豆浆不太好喝，这里，为您推荐一种长寿五豆豆浆，就是将黄豆、黑豆、青豆、豌豆、花生米五种豆按 1:1:1:1:1 的比例配好，浸泡0.5 ~1小时后洗净，与适量清水一起打浆后煮开即可饮用。<br>    原址：<a href="http://gd.sina.com.cn/yj/life/2015-01-14/083515454.html" target="_blank" rel="external">http://gd.sina.com.cn/yj/life/2015-01-14/083515454.html</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<p>　　一、豆浆性质偏寒，消化不良、嗝气和肾功能不好的人，最好少喝豆浆。另外，急性胃炎和慢性浅表性胃炎者不宜食用豆制品，以免刺激胃酸分泌过多加重病情，或者引起胃肠胀气。</p>
<p>　　二、豆浆里不能加红糖，因为红糖里面有多种有机酸，它们和豆浆里的蛋白酶结合，不容易被人体吸收]]>
    </summary>
    
      <category term="转载" scheme="http://yoursite.com/tags/%E8%BD%AC%E8%BD%BD/"/>
    
      <category term="生活" scheme="http://yoursite.com/tags/%E7%94%9F%E6%B4%BB/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Hello World]]></title>
    <link href="http://yoursite.com/2015/02/21/hello-world/"/>
    <id>http://yoursite.com/2015/02/21/hello-world/</id>
    <published>2015-02-21T13:34:36.835Z</published>
    <updated>2015-02-09T09:38:10.313Z</updated>
    <content type="html"><![CDATA[<p>Welcome to <a href="http://hexo.io/" target="_blank" rel="external">Hexo</a>! This is your very first post. Check <a href="http://hexo.io/docs/" target="_blank" rel="external">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="http://hexo.io/docs/troubleshooting.html" target="_blank" rel="external">trobuleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="external">GitHub</a>.</p>
<h2 id="Quick_Start">Quick Start</h2>
<h3 id="Create_a_new_post">Create a new post</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo new <span class="string">"My New Post"</span></div></pre></td></tr></table></figure>

<p>More info: <a href="http://hexo.io/docs/writing.html" target="_blank" rel="external">Writing</a></p>
<h3 id="Run_server">Run server</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo server</div></pre></td></tr></table></figure>

<p>More info: <a href="http://hexo.io/docs/server.html" target="_blank" rel="external">Server</a></p>
<h3 id="Generate_static_files">Generate static files</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo generate</div></pre></td></tr></table></figure>

<p>More info: <a href="http://hexo.io/docs/generating.html" target="_blank" rel="external">Generating</a></p>
<h3 id="Deploy_to_remote_sites">Deploy to remote sites</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo deploy</div></pre></td></tr></table></figure>

<p>More info: <a href="http://hexo.io/docs/deployment.html" target="_blank" rel="external">Deployment</a></p>
]]></content>
    <summary type="html">
    <![CDATA[<p>Welcome to <a href="http://hexo.io/" target="_blank" rel="external">Hexo</a>! This is your very first post. Check <a href="http://hexo.io]]>
    </summary>
    
  </entry>
  
  <entry>
    <title><![CDATA[网址备忘]]></title>
    <link href="http://yoursite.com/2015/02/09/%E7%BD%91%E5%9D%80%E5%A4%87%E5%BF%98/"/>
    <id>http://yoursite.com/2015/02/09/网址备忘/</id>
    <published>2015-02-09T09:40:51.000Z</published>
    <updated>2015-03-01T15:56:18.236Z</updated>
    <content type="html"><![CDATA[<p>Hexo博客相关网址收集</p>
<ul>
<li>Hexo详细攻略<a href="http://ibruce.info/2013/11/22/hexo-your-blog/" target="_blank" rel="external">http://ibruce.info/2013/11/22/hexo-your-blog/</a></li>
<li>Sublime Text 2 入门及技巧 <a href="http://lucifr.com/2011/08/31/sublime-text-2-tricks-and-tips/" target="_blank" rel="external">http://lucifr.com/2011/08/31/sublime-text-2-tricks-and-tips/</a></li>
<li>Markdown 语法说明 <a href="http://wowubuntu.com/markdown/#link" target="_blank" rel="external">http://wowubuntu.com/markdown/#link</a></li>
<li>Markdown简明语法<a href="http://ibruce.info/2013/11/26/markdown/" target="_blank" rel="external">http://ibruce.info/2013/11/26/markdown/</a></li>
<li>利用swiftype为hexo添加站内搜索<a href="http://www.jerryfu.net/post/search-engine-for-hexo-with-swiftype.html" target="_blank" rel="external">http://www.jerryfu.net/post/search-engine-for-hexo-with-swiftype.html</a></li>
<li>Mac下搭建hexo<a href="http://www.tuicool.com/articles/iI77na" target="_blank" rel="external">http://www.tuicool.com/articles/iI77na</a></li>
</ul>
]]></content>
    <summary type="html">
    <![CDATA[<p>Hexo博客相关网址收集</p>
<ul>
<li>Hexo详细攻略<a href="http://ibruce.info/2013/11/22/hexo-your-blog/" target="_blank" rel="external">http://ibruce.in]]>
    </summary>
    
  </entry>
  
</feed>
